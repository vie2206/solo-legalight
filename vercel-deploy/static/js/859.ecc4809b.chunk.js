"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[859],{8859:(e,s,t)=>{t.r(s),t.d(s,{default:()=>V});var a=t(9950),r=t(2414),n=t(1818),l=t(9818),d=t(6123),c=t(5066),i=t(3720),o=t(2555),x=t(706),m=t(9696),u=t(1435),h=t(7491),g=t(9530),p=t(6467),b=t(4206),y=t(4414);const j=e=>{let{onClose:s,onSave:t,parentCollections:r}=e;const[n,l]=(0,a.useState)(""),[d,c]=(0,a.useState)(""),[i,x]=(0,a.useState)("");return(0,y.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,y.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,y.jsx)("h3",{className:"text-lg font-bold mb-4",children:"Create Collection"}),(0,y.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=localStorage.getItem("auth_token"),s="https://api.legalight.org.in";await fetch("".concat(s,"/api/flashcards/collections"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({name:n,description:d,parent_id:i||null})}),t()}catch(s){console.error("Failed to create collection:",s)}},className:"space-y-4",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),(0,y.jsx)("input",{type:"text",value:n,onChange:e=>l(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,y.jsx)("textarea",{value:d,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Parent Collection"}),(0,y.jsxs)("select",{value:i,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,y.jsx)("option",{value:"",children:"None (Root Level)"}),(e=>{const s=[],t=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.forEach(e=>{s.push((0,o.A)((0,o.A)({},e),{},{name:"  ".repeat(a)+e.name})),e.children&&t(e.children,a+1)})};return t(e),s})(r).map(e=>(0,y.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,y.jsxs)("div",{className:"flex space-x-3",children:[(0,y.jsx)("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,y.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Create"})]})]})]})})},f=e=>{let{onClose:s,onSave:t,collections:r}=e;const[n,l]=(0,a.useState)(""),[d,c]=(0,a.useState)(""),[i,x]=(0,a.useState)("");return(0,y.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,y.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,y.jsx)("h3",{className:"text-lg font-bold mb-4",children:"Create Deck"}),(0,y.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=localStorage.getItem("auth_token"),s="https://api.legalight.org.in";await fetch("".concat(s,"/api/flashcards/decks"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({name:n,description:d,collection_id:i||null})}),t()}catch(s){console.error("Failed to create deck:",s)}},className:"space-y-4",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),(0,y.jsx)("input",{type:"text",value:n,onChange:e=>l(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,y.jsx)("textarea",{value:d,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Collection"}),(0,y.jsxs)("select",{value:i,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,y.jsx)("option",{value:"",children:"None (Uncategorized)"}),(e=>{const s=[],t=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.forEach(e=>{s.push((0,o.A)((0,o.A)({},e),{},{name:"  ".repeat(a)+e.name})),e.children&&t(e.children,a+1)})};return t(e),s})(r).map(e=>(0,y.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,y.jsxs)("div",{className:"flex space-x-3",children:[(0,y.jsx)("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,y.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Create"})]})]})]})})},v=e=>{let{deckId:s,onClose:t,onSave:r}=e;const[n,l]=(0,a.useState)({new_cards_per_day:20,max_reviews_per_day:200,learning_steps:[1,10],graduating_interval:1,easy_interval:4,starting_ease:2.5,easy_bonus:1.3,interval_modifier:1,maximum_interval:36500});return(0,y.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,y.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,y.jsx)("h3",{className:"text-lg font-bold mb-4",children:"Deck Settings"}),(0,y.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=localStorage.getItem("auth_token"),t="https://api.legalight.org.in";await fetch("".concat(t,"/api/flashcards/decks/").concat(s,"/settings"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(n)}),r()}catch(t){console.error("Failed to update deck settings:",t)}},className:"space-y-6",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("h4",{className:"font-medium text-gray-900 mb-3",children:"Daily Limits"}),(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New cards per day"}),(0,y.jsx)("input",{type:"number",value:n.new_cards_per_day,onChange:e=>l(s=>(0,o.A)((0,o.A)({},s),{},{new_cards_per_day:parseInt(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0"})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Maximum reviews per day"}),(0,y.jsx)("input",{type:"number",value:n.max_reviews_per_day,onChange:e=>l(s=>(0,o.A)((0,o.A)({},s),{},{max_reviews_per_day:parseInt(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0"})]})]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h4",{className:"font-medium text-gray-900 mb-3",children:"Learning"}),(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Learning steps (minutes)"}),(0,y.jsx)("input",{type:"text",value:n.learning_steps.join(" "),onChange:e=>{const s=e.target.value.split(" ").map(e=>parseInt(e.trim())).filter(e=>!isNaN(e));l(e=>(0,o.A)((0,o.A)({},e),{},{learning_steps:s}))},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"1 10"}),(0,y.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Space-separated values"})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Graduating interval (days)"}),(0,y.jsx)("input",{type:"number",value:n.graduating_interval,onChange:e=>l(s=>(0,o.A)((0,o.A)({},s),{},{graduating_interval:parseInt(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1"})]})]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h4",{className:"font-medium text-gray-900 mb-3",children:"Advanced"}),(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Easy interval (days)"}),(0,y.jsx)("input",{type:"number",value:n.easy_interval,onChange:e=>l(s=>(0,o.A)((0,o.A)({},s),{},{easy_interval:parseInt(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1"})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Starting ease"}),(0,y.jsx)("input",{type:"number",step:"0.01",value:n.starting_ease,onChange:e=>l(s=>(0,o.A)((0,o.A)({},s),{},{starting_ease:parseFloat(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1.3",max:"5.0"})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Easy bonus"}),(0,y.jsx)("input",{type:"number",step:"0.01",value:n.easy_bonus,onChange:e=>l(s=>(0,o.A)((0,o.A)({},s),{},{easy_bonus:parseFloat(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1.0",max:"3.0"})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Interval modifier"}),(0,y.jsx)("input",{type:"number",step:"0.01",value:n.interval_modifier,onChange:e=>l(s=>(0,o.A)((0,o.A)({},s),{},{interval_modifier:parseFloat(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0.5",max:"2.0"})]})]})]}),(0,y.jsxs)("div",{className:"flex space-x-3",children:[(0,y.jsx)("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,y.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Save Settings"})]})]})]})})},N=e=>{var s;let{userId:t,onDeckSelect:n,onCreateCard:l}=e;const[d,c]=(0,a.useState)([]),[i,N]=(0,a.useState)(new Set),[w,k]=(0,a.useState)(null),[_,A]=(0,a.useState)(!1),[C,S]=(0,a.useState)(!1),[I,D]=(0,a.useState)(null),[z,T]=(0,a.useState)(!0),R="https://api.legalight.org.in";(0,a.useEffect)(()=>{E()},[t]);const E=async()=>{try{T(!0);const e=localStorage.getItem("auth_token"),s=await fetch("".concat(R,"/api/flashcards/collections"),{headers:{Authorization:"Bearer ".concat(e)}}),t=await s.json(),a=await fetch("".concat(R,"/api/flashcards/decks"),{headers:{Authorization:"Bearer ".concat(e)}}),r=await a.json(),n=F(t,r);c(n)}catch(e){console.error("Failed to load collections and decks:",e)}finally{T(!1)}},F=(e,s)=>{const t=new Map,a=[];e.forEach(e=>{t.set(e.id,(0,o.A)((0,o.A)({},e),{},{children:[],decks:s.filter(s=>s.collection_id===e.id)}))}),e.forEach(e=>{const s=t.get(e.id);if(e.parent_id){const a=t.get(e.parent_id);a&&a.children.push(s)}else a.push(s)});const r=s.filter(e=>!e.collection_id);return r.length>0&&a.push({id:"root",name:"Uncategorized",description:"Decks without a collection",children:[],decks:r,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}),a},B=function(e){var s,t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const d=i.has(e.id),c=e.children&&e.children.length>0||e.decks&&e.decks.length>0;return(0,y.jsxs)("div",{className:"".concat(a>0?"ml-4":""),children:[(0,y.jsxs)("div",{className:"flex items-center justify-between py-2 px-3 hover:bg-gray-50 rounded-lg cursor-pointer group",onClick:()=>{return c&&(s=e.id,void N(e=>{const t=new Set(e);return t.has(s)?t.delete(s):t.add(s),t}));var s},children:[(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,y.jsxs)("div",{className:"flex items-center",children:[c&&(0,y.jsx)("button",{className:"p-1 hover:bg-gray-200 rounded",children:d?(0,y.jsx)(x.A,{className:"h-4 w-4 text-gray-500"}):(0,y.jsx)(m.A,{className:"h-4 w-4 text-gray-500"})}),(0,y.jsx)(u.A,{className:"h-5 w-5 text-blue-500 ml-2"})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h3",{className:"font-medium text-gray-900",children:e.name}),e.description&&(0,y.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]})]}),(0,y.jsxs)("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,y.jsx)("button",{onClick:e=>{e.stopPropagation(),S(!0)},className:"p-1 hover:bg-gray-200 rounded text-gray-500 hover:text-gray-700",title:"Add Deck",children:(0,y.jsx)(h.A,{className:"h-4 w-4"})}),(0,y.jsx)("button",{className:"p-1 hover:bg-gray-200 rounded text-gray-500 hover:text-gray-700",title:"Edit Collection",children:(0,y.jsx)(g.A,{className:"h-4 w-4"})}),"root"!==e.id&&(0,y.jsx)("button",{className:"p-1 hover:bg-gray-200 rounded text-gray-500 hover:text-red-600",title:"Delete Collection",children:(0,y.jsx)(p.A,{className:"h-4 w-4"})})]})]}),d&&(0,y.jsxs)("div",{className:"ml-4 mt-2 space-y-1",children:[null===(s=e.children)||void 0===s?void 0:s.map(e=>B(e,a+1)),null===(t=e.decks)||void 0===t?void 0:t.map(e=>(0,y.jsxs)("div",{className:"flex items-center justify-between py-2 px-3 rounded-lg cursor-pointer transition-colors ".concat(w===e.id?"bg-blue-50 border border-blue-200":"hover:bg-gray-50"),onClick:()=>(e=>{k(e.id),n(e)})(e),children:[(0,y.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,y.jsx)(r.A,{className:"h-5 w-5 text-green-500"}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),e.description&&(0,y.jsx)("p",{className:"text-sm text-gray-500",children:e.description}),(0,y.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500 mt-1",children:[(0,y.jsxs)("span",{className:"text-blue-600",children:[e.new_cards," new"]}),(0,y.jsxs)("span",{className:"text-orange-600",children:[e.learning_cards," learning"]}),(0,y.jsxs)("span",{className:"text-green-600",children:[e.review_cards," review"]}),(0,y.jsxs)("span",{className:"font-medium text-red-600",children:[e.due_cards," due"]})]})]})]}),(0,y.jsxs)("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,y.jsx)("button",{onClick:s=>{s.stopPropagation(),l(e.id)},className:"p-1 hover:bg-gray-200 rounded text-gray-500 hover:text-green-600",title:"Add Card",children:(0,y.jsx)(h.A,{className:"h-4 w-4"})}),(0,y.jsx)("button",{onClick:s=>{s.stopPropagation(),D(e.id)},className:"p-1 hover:bg-gray-200 rounded text-gray-500 hover:text-gray-700",title:"Deck Settings",children:(0,y.jsx)(b.A,{className:"h-4 w-4"})}),(0,y.jsx)("button",{className:"p-1 hover:bg-gray-200 rounded text-gray-500 hover:text-red-600",title:"Delete Deck",children:(0,y.jsx)(p.A,{className:"h-4 w-4"})})]})]},e.id))]})]},e.id)};return z?(0,y.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,y.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,y.jsxs)("div",{className:"bg-white rounded-lg shadow-lg",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,y.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Deck Manager"}),(0,y.jsxs)("div",{className:"flex space-x-2",children:[(0,y.jsxs)("button",{onClick:()=>A(!0),className:"px-3 py-2 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-lg text-sm font-medium transition-colors flex items-center space-x-1",children:[(0,y.jsx)(u.A,{className:"h-4 w-4"}),(0,y.jsx)("span",{children:"New Collection"})]}),(0,y.jsxs)("button",{onClick:()=>S(!0),className:"px-3 py-2 bg-green-100 hover:bg-green-200 text-green-700 rounded-lg text-sm font-medium transition-colors flex items-center space-x-1",children:[(0,y.jsx)(r.A,{className:"h-4 w-4"}),(0,y.jsx)("span",{children:"New Deck"})]})]})]}),(0,y.jsx)("div",{className:"p-4 max-h-96 overflow-y-auto",children:0===d.length?(0,y.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,y.jsx)(u.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,y.jsx)("p",{className:"text-lg font-medium",children:"No collections yet"}),(0,y.jsx)("p",{className:"text-sm",children:"Create your first collection to organize your flashcard decks"})]}):(0,y.jsx)("div",{className:"space-y-2",children:d.map(e=>B(e))})}),w&&(0,y.jsxs)("div",{className:"border-t border-gray-200 p-4 bg-gray-50",children:[(0,y.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Study Today"}),(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,y.jsx)("button",{onClick:()=>{const e=d.flatMap(e=>e.decks||[]).find(e=>e.id===w);e&&e.due_cards>0&&console.log("Starting study session for deck:",e.id)},className:"bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg font-medium transition-colors",disabled:!(null!==(s=d.flatMap(e=>e.decks||[]).find(e=>e.id===w))&&void 0!==s&&s.due_cards),children:"Study Now"}),(0,y.jsx)("button",{onClick:()=>{const e=d.flatMap(e=>e.decks||[]).find(e=>e.id===w);e&&l(e.id)},className:"bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg font-medium transition-colors",children:"Add Cards"})]})]}),_&&(0,y.jsx)(j,{onClose:()=>A(!1),onSave:()=>{A(!1),E()},parentCollections:d}),C&&(0,y.jsx)(f,{onClose:()=>S(!1),onSave:()=>{S(!1),E()},collections:d}),I&&(0,y.jsx)(v,{deckId:I,onClose:()=>D(null),onSave:()=>{D(null),E()}})]})},w=[{id:"basic",name:"Basic",description:"Simple front and back card",fields:[{name:"Front",type:"text",required:!0},{name:"Back",type:"html",required:!0}],templates:[{name:"Card 1",question:"{{Front}}",answer:"{{Back}}"}],css:".card { font-family: arial; font-size: 20px; text-align: center; color: black; background-color: white; }",javascript:"",is_builtin:!0},{id:"basic-reverse",name:"Basic (and reversed card)",description:"Two cards: Front\u2192Back and Back\u2192Front",fields:[{name:"Front",type:"text",required:!0},{name:"Back",type:"html",required:!0}],templates:[{name:"Card 1",question:"{{Front}}",answer:"{{Back}}"},{name:"Card 2",question:"{{Back}}",answer:"{{Front}}"}],css:".card { font-family: arial; font-size: 20px; text-align: center; color: black; background-color: white; }",javascript:"",is_builtin:!0},{id:"cloze",name:"Cloze",description:"Fill-in-the-blank cards with cloze deletions",fields:[{name:"Text",type:"html",required:!0},{name:"Extra",type:"html",required:!1}],templates:[{name:"Cloze",question:"{{cloze:Text}}",answer:"{{cloze:Text}}<br>{{Extra}}"}],css:".card { font-family: arial; font-size: 20px; text-align: center; color: black; background-color: white; } .cloze { font-weight: bold; color: blue; }",javascript:"",is_builtin:!0},{id:"image-occlusion",name:"Image Occlusion",description:"Hide parts of images for visual learning",fields:[{name:"Image",type:"image",required:!0},{name:"Header",type:"text",required:!1},{name:"Footer",type:"text",required:!1}],templates:[{name:"Card",question:"{{Header}}<br>{{Image}}",answer:"{{Header}}<br>{{Image}}<br>{{Footer}}"}],css:".card { font-family: arial; font-size: 20px; text-align: center; color: black; background-color: white; }",javascript:"",is_builtin:!0}],k=e=>{let{onSave:s,onCancel:t,initialNote:r,deckId:n}=e;const[l,d]=(0,a.useState)(w[0]),[c,i]=(0,a.useState)({}),[x,m]=(0,a.useState)(""),[u,h]=(0,a.useState)(!1),[g,p]=(0,a.useState)([]);(0,a.useEffect)(()=>{if(r){const s=[...w,...g].find(e=>e.id===r.note_type_id);var e;if(s)d(s),i(r.fields||{}),m((null===(e=r.tags)||void 0===e?void 0:e.join(", "))||"")}},[r,g]);const b=(e,s)=>{i(t=>(0,o.A)((0,o.A)({},t),{},{[e]:s}))},j=e=>{const s=c[e.name]||"";switch(e.type){case"text":default:return(0,y.jsx)("input",{type:"text",value:s,onChange:s=>b(e.name,s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter ".concat(e.name),required:e.required});case"html":return(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)("textarea",{value:s,onChange:s=>b(e.name,s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 h-32",placeholder:"Enter ".concat(e.name," (HTML supported)"),required:e.required}),(0,y.jsxs)("div",{className:"flex space-x-2",children:[(0,y.jsx)("button",{type:"button",onClick:()=>b(e.name,s+"<b></b>"),className:"px-2 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm",children:(0,y.jsx)("b",{children:"B"})}),(0,y.jsx)("button",{type:"button",onClick:()=>b(e.name,s+"<i></i>"),className:"px-2 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm",children:(0,y.jsx)("i",{children:"I"})}),(0,y.jsx)("button",{type:"button",onClick:()=>b(e.name,s+"<u></u>"),className:"px-2 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm",children:(0,y.jsx)("u",{children:"U"})})]})]});case"image":return(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)("input",{type:"file",accept:"image/*",onChange:s=>{var t;const a=null===(t=s.target.files)||void 0===t?void 0:t[0];a&&b(e.name,"[image:".concat(a.name,"]"))},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),s&&(0,y.jsxs)("div",{className:"text-sm text-gray-600",children:["Current: ",s]})]})}};return(0,y.jsxs)("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-lg",children:[(0,y.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,y.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:r?"Edit Card":"Add New Card"}),(0,y.jsxs)("div",{className:"flex space-x-2",children:[(0,y.jsxs)("button",{onClick:()=>h(!u),className:"px-4 py-2 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-lg transition-colors",children:[u?"Hide":"Show"," Preview"]}),(0,y.jsx)("button",{onClick:t,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors",children:"Cancel"})]})]}),(0,y.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,y.jsxs)("div",{className:"space-y-6",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Card Type"}),(0,y.jsxs)("select",{value:l.id,onChange:e=>{const s=[...w,...g].find(s=>s.id===e.target.value);s&&(d(s),i({}))},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,y.jsx)("optgroup",{label:"Built-in Types",children:w.map(e=>(0,y.jsx)("option",{value:e.id,children:e.name},e.id))}),g.length>0&&(0,y.jsx)("optgroup",{label:"Custom Types",children:g.map(e=>(0,y.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,y.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:l.description})]}),"cloze"===l.id&&(0,y.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,y.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"Cloze Deletion Help"}),(0,y.jsxs)("p",{className:"text-sm text-blue-800 mb-2",children:["Use ",(0,y.jsx)("code",{children:"{{c1::text}}"})," to create cloze deletions:"]}),(0,y.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,y.jsxs)("li",{children:["\u2022 ",(0,y.jsx)("code",{children:"{{c1::Paris}}"})," is the capital of France"]}),(0,y.jsxs)("li",{children:["\u2022 The chemical formula for water is ",(0,y.jsx)("code",{children:"{{c1::H2O}}"})]}),(0,y.jsx)("li",{children:"\u2022 Use c1, c2, c3... for multiple deletions"})]})]}),(0,y.jsx)("div",{className:"space-y-4",children:l.fields.map(e=>(0,y.jsxs)("div",{children:[(0,y.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.name,e.required&&(0,y.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),j(e)]},e.name))}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),(0,y.jsx)("input",{type:"text",value:x,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter tags separated by commas"}),(0,y.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Use tags to organize and search your cards"})]}),(0,y.jsx)("div",{className:"flex space-x-3",children:(0,y.jsx)("button",{onClick:()=>{const e=l.fields.filter(e=>e.required&&!c[e.name]).map(e=>e.name);if(e.length>0)return void alert("Please fill in required fields: ".concat(e.join(", ")));const t={note_type_id:l.id,deck_id:n,fields:c,tags:x.split(",").map(e=>e.trim()).filter(e=>e.length>0)};s(t)},className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg font-medium transition-colors",children:r?"Update Card":"Add Card"})})]}),u&&(0,y.jsx)("div",{className:"lg:sticky lg:top-6",children:(()=>{if(!l.templates.length)return null;const e=l.templates[0];let s=e.question,t=e.answer;return l.fields.forEach(e=>{const a=c[e.name]||"",r="{{".concat(e.name,"}}");if("Text"===e.name&&"cloze"===l.id){const e=a.replace(/\{\{c\d+::([^}]+)\}\}/g,"[...]");s=s.replace("{{cloze:Text}}",e),t=t.replace("{{cloze:Text}}",a)}else s=s.replace(r,a),t=t.replace(r,a)}),(0,y.jsxs)("div",{className:"border rounded-lg p-4 bg-gray-50",children:[(0,y.jsx)("h4",{className:"font-semibold mb-2",children:"Preview"}),(0,y.jsxs)("div",{className:"space-y-4",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("h5",{className:"text-sm font-medium text-gray-700",children:"Question:"}),(0,y.jsx)("div",{className:"border rounded p-3 bg-white",dangerouslySetInnerHTML:{__html:s},style:{minHeight:"60px"}})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h5",{className:"text-sm font-medium text-gray-700",children:"Answer:"}),(0,y.jsx)("div",{className:"border rounded p-3 bg-white",dangerouslySetInnerHTML:{__html:t},style:{minHeight:"60px"}})]})]})]})})()})]})]})};var _=t(5536),A=t(4725),C=t(6923),S=t(6536);const I=e=>{let{deckId:s,onComplete:t,onExit:r}=e;const[n,l]=(0,a.useState)(null),[d,c]=(0,a.useState)([]),[i,x]=(0,a.useState)(!1),[m,u]=(0,a.useState)({cards_studied:0,new_cards:0,learning_cards:0,review_cards:0,correct_answers:0,incorrect_answers:0,session_duration:0}),[h]=(0,a.useState)(new Date),[g,p]=(0,a.useState)(null),[b,j]=(0,a.useState)(!0),[f,v]=(0,a.useState)(null),N="https://api.legalight.org.in",w=(0,a.useCallback)(async()=>{try{j(!0);const e=localStorage.getItem("auth_token"),a=await fetch("".concat(N,"/api/flashcards/decks/").concat(s,"/study"),{headers:{Authorization:"Bearer ".concat(e)}});if(!a.ok)throw new Error("Failed to load study cards");const r=await a.json();if(0===r.length)return void t(m);c(r),l(r[0]),p(new Date),x(!1)}catch(e){v(e instanceof Error?e.message:"Failed to load cards")}finally{j(!1)}},[s,t,m]);(0,a.useEffect)(()=>{w()},[w]);const k=function(e,s){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e;return Object.entries(s).forEach(s=>{let[r,n]=s;const l="{{".concat(r,"}}");if("Text"===r&&e.includes("{{cloze:Text}}")){const e=function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e.replace(/\{\{c\d+::([^}]+)\}\}/g,'<span class="cloze-answer">$1</span>'):e.replace(/\{\{c\d+::([^}]+)\}\}/g,'<span class="cloze-deletion">[...]</span>')}(n,t);a=a.replace("{{cloze:Text}}",e)}else a=a.replace(l,n)}),a=a.replace(/\{\{[^}]+\}\}/g,""),a},I=async e=>{if(!n||!g)return;const s=Date.now()-g.getTime();try{const a=localStorage.getItem("auth_token");await fetch("".concat(N,"/api/flashcards/cards/").concat(n.id,"/answer"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({answer_quality:e,time_taken:s})}),u(s=>(0,o.A)((0,o.A)({},s),{},{cards_studied:s.cards_studied+1,new_cards:s.new_cards+(0===n.card_type?1:0),learning_cards:s.learning_cards+(1===n.card_type||3===n.card_type?1:0),review_cards:s.review_cards+(2===n.card_type?1:0),correct_answers:s.correct_answers+(e>=3?1:0),incorrect_answers:s.incorrect_answers+(e<3?1:0),session_duration:Math.floor((Date.now()-h.getTime())/1e3)}));const r=d.slice(1);if(0===r.length){const e=(0,o.A)((0,o.A)({},m),{},{cards_studied:m.cards_studied+1,session_duration:Math.floor((Date.now()-h.getTime())/1e3)});t(e)}else c(r),l(r[0]),p(new Date),x(!1)}catch(a){v("Failed to answer card")}};if(b)return(0,y.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,y.jsxs)("div",{className:"text-center",children:[(0,y.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,y.jsx)("p",{className:"text-gray-600",children:"Loading study session..."})]})});if(f)return(0,y.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,y.jsxs)("div",{className:"text-center",children:[(0,y.jsx)(_.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,y.jsx)("p",{className:"text-red-600 mb-4",children:f}),(0,y.jsx)("button",{onClick:r,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg",children:"Back to Deck"})]})});if(!n)return(0,y.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,y.jsxs)("div",{className:"text-center",children:[(0,y.jsx)(A.A,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),(0,y.jsx)("p",{className:"text-gray-600",children:"No cards to study right now!"}),(0,y.jsx)("button",{onClick:r,className:"mt-4 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg",children:"Back to Deck"})]})});return(0,y.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,y.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,y.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-4",children:(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,y.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat({0:"bg-blue-100 text-blue-800",1:"bg-orange-100 text-orange-800",2:"bg-green-100 text-green-800",3:"bg-red-100 text-red-800"}[n.card_type]),children:{0:"New",1:"Learning",2:"Review",3:"Relearning"}[n.card_type]}),(0,y.jsxs)("span",{className:"text-sm text-gray-600",children:[d.length," cards remaining"]})]}),(0,y.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[(0,y.jsx)(C.A,{className:"h-4 w-4"}),(0,y.jsxs)("span",{children:[Math.floor(m.session_duration/60),":",(m.session_duration%60).toString().padStart(2,"0")]})]}),(0,y.jsxs)("div",{className:"text-sm text-gray-600",children:["Studied: ",m.cards_studied]}),(0,y.jsx)("button",{onClick:r,className:"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded",children:"Exit"})]})]})})}),(0,y.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,y.jsxs)("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[(0,y.jsxs)("div",{className:"p-8",children:[(0,y.jsx)("div",{className:"mb-8",children:(0,y.jsx)("div",{className:"text-center text-lg leading-relaxed min-h-[200px] flex items-center justify-center",dangerouslySetInnerHTML:{__html:k(n.template.question,n.note.fields,!1)}})}),i&&(0,y.jsx)("div",{className:"border-t pt-8",children:(0,y.jsx)("div",{className:"text-center text-lg leading-relaxed min-h-[200px] flex items-center justify-center",dangerouslySetInnerHTML:{__html:k(n.template.answer,n.note.fields,!0)}})})]}),(0,y.jsx)("div",{className:"bg-gray-50 px-8 py-6",children:i?(0,y.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[(0,y.jsxs)("button",{onClick:()=>I(1),className:"px-4 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors",children:["Again",(0,y.jsx)("div",{className:"text-xs opacity-80",children:"<1min"})]}),(0,y.jsxs)("button",{onClick:()=>I(2),className:"px-4 py-3 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-medium transition-colors",children:["Hard",(0,y.jsx)("div",{className:"text-xs opacity-80",children:"<6min"})]}),(0,y.jsxs)("button",{onClick:()=>I(3),className:"px-4 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors",children:["Good",(0,y.jsx)("div",{className:"text-xs opacity-80",children:0===n.card_type?"1d":"".concat(Math.round(n.interval*n.ease_factor),"d")})]}),(0,y.jsxs)("button",{onClick:()=>I(4),className:"px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:["Easy",(0,y.jsx)("div",{className:"text-xs opacity-80",children:0===n.card_type?"4d":"".concat(Math.round(n.interval*n.ease_factor*1.3),"d")})]})]}):(0,y.jsx)("div",{className:"flex justify-center",children:(0,y.jsxs)("button",{onClick:()=>x(!0),className:"flex items-center space-x-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:[(0,y.jsx)(S.A,{className:"h-5 w-5"}),(0,y.jsx)("span",{children:"Show Answer"})]})})})]}),(0,y.jsxs)("div",{className:"mt-6",children:[(0,y.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[(0,y.jsx)("span",{children:"Progress"}),(0,y.jsxs)("span",{children:[m.cards_studied," / ",m.cards_studied+d.length]})]}),(0,y.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,y.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(m.cards_studied/(m.cards_studied+d.length)*100,"%")}})})]}),(0,y.jsxs)("div",{className:"mt-6 grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,y.jsxs)("div",{className:"bg-white rounded-lg p-4 text-center",children:[(0,y.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:m.new_cards}),(0,y.jsx)("div",{className:"text-sm text-gray-600",children:"New"})]}),(0,y.jsxs)("div",{className:"bg-white rounded-lg p-4 text-center",children:[(0,y.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:m.learning_cards}),(0,y.jsx)("div",{className:"text-sm text-gray-600",children:"Learning"})]}),(0,y.jsxs)("div",{className:"bg-white rounded-lg p-4 text-center",children:[(0,y.jsx)("div",{className:"text-2xl font-bold text-green-600",children:m.review_cards}),(0,y.jsx)("div",{className:"text-sm text-gray-600",children:"Review"})]}),(0,y.jsxs)("div",{className:"bg-white rounded-lg p-4 text-center",children:[(0,y.jsx)("div",{className:"text-2xl font-bold text-green-600",children:m.correct_answers}),(0,y.jsx)("div",{className:"text-sm text-gray-600",children:"Correct"})]}),(0,y.jsxs)("div",{className:"bg-white rounded-lg p-4 text-center",children:[(0,y.jsx)("div",{className:"text-2xl font-bold text-red-600",children:m.incorrect_answers}),(0,y.jsx)("div",{className:"text-sm text-gray-600",children:"Incorrect"})]})]}),n.note.tags.length>0&&(0,y.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:n.note.tags.map(e=>(0,y.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:e},e))})]}),(0,y.jsx)("style",{children:"\n        .cloze-deletion {\n          background-color: #3b82f6;\n          color: white;\n          padding: 2px 8px;\n          border-radius: 4px;\n          font-weight: bold;\n        }\n        .cloze-answer {\n          background-color: #10b981;\n          color: white;\n          padding: 2px 8px;\n          border-radius: 4px;\n          font-weight: bold;\n        }\n      "})]})};var D=t(88),z=(t(9361),t(619)),T=t(3302);const R=e=>{let{userId:s,selectedDeckId:t}=e;const[r,l]=(0,a.useState)([]),[d,c]=(0,a.useState)([]),[o,x]=(0,a.useState)([]),[m,u]=(0,a.useState)([]),[h,g]=(0,a.useState)([]),[p,b]=(0,a.useState)(!0),[j,f]=(0,a.useState)("30d"),[v,N]=(0,a.useState)("overview"),w="https://api.legalight.org.in";(0,a.useEffect)(()=>{k()},[s,t,j]);const k=async()=>{try{b(!0);const e=localStorage.getItem("auth_token"),s=t?"?deck_id=".concat(t):"",a=t?"&period=".concat(j):"?period=".concat(j),[r,n,d,i,o]=await Promise.all([fetch("".concat(w,"/api/flashcards/analytics/deck-stats").concat(s),{headers:{Authorization:"Bearer ".concat(e)}}),fetch("".concat(w,"/api/flashcards/analytics/sessions").concat(s).concat(a),{headers:{Authorization:"Bearer ".concat(e)}}),fetch("".concat(w,"/api/flashcards/analytics/learning").concat(s).concat(a),{headers:{Authorization:"Bearer ".concat(e)}}),fetch("".concat(w,"/api/flashcards/analytics/retention").concat(s).concat(a),{headers:{Authorization:"Bearer ".concat(e)}}),fetch("".concat(w,"/api/flashcards/analytics/workload").concat(s),{headers:{Authorization:"Bearer ".concat(e)}})]),[m,h,p,y,f]=await Promise.all([r.json(),n.json(),d.json(),i.json(),o.json()]);l(m),c(h),x(p),u(y),g(f)}catch(e){console.error("Failed to load analytics data:",e)}finally{b(!1)}},_=e=>{const s=Math.floor(e/3600),t=Math.floor(e%3600/60);return s>0?"".concat(s,"h ").concat(t,"m"):"".concat(t,"m")},A=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"}),I=o.reduce((e,s)=>e+s.cards_studied,0),R=o.reduce((e,s)=>e+s.time_studied,0),E=o.length>0?o.reduce((e,s)=>e+s.accuracy_rate,0)/o.length:0,F=o.length>0?o.reduce((e,s)=>e+s.retention_rate,0)/o.length:0;return p?(0,y.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,y.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,y.jsxs)("div",{className:"bg-white rounded-lg shadow-lg",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,y.jsx)(n.A,{className:"h-6 w-6 text-blue-600"}),(0,y.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Analytics Dashboard"})]}),(0,y.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,y.jsxs)("select",{value:j,onChange:e=>f(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,y.jsx)("option",{value:"7d",children:"Last 7 days"}),(0,y.jsx)("option",{value:"30d",children:"Last 30 days"}),(0,y.jsx)("option",{value:"90d",children:"Last 90 days"}),(0,y.jsx)("option",{value:"1y",children:"Last year"})]}),(0,y.jsx)("button",{onClick:k,className:"p-2 hover:bg-gray-100 rounded-lg",title:"Refresh",children:(0,y.jsx)(z.A,{className:"h-5 w-5 text-gray-600"})})]})]}),(0,y.jsx)("div",{className:"border-b border-gray-200",children:(0,y.jsx)("nav",{className:"flex space-x-8 px-6",children:[{id:"overview",label:"Overview",icon:n.A},{id:"retention",label:"Retention",icon:D.A},{id:"workload",label:"Workload",icon:T.A},{id:"sessions",label:"Sessions",icon:C.A}].map(e=>(0,y.jsxs)("button",{onClick:()=>N(e.id),className:"flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm ".concat(v===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,y.jsx)(e.icon,{className:"h-4 w-4"}),(0,y.jsx)("span",{children:e.label})]},e.id))})}),(0,y.jsxs)("div",{className:"p-6",children:["overview"===v&&(0,y.jsxs)("div",{className:"space-y-6",children:[(0,y.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,y.jsx)("div",{className:"bg-blue-50 rounded-lg p-4",children:(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{className:"text-sm font-medium text-blue-600",children:"Cards Studied"}),(0,y.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:I})]}),(0,y.jsx)(i.A,{className:"h-8 w-8 text-blue-600"})]})}),(0,y.jsx)("div",{className:"bg-green-50 rounded-lg p-4",children:(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{className:"text-sm font-medium text-green-600",children:"Time Studied"}),(0,y.jsx)("p",{className:"text-2xl font-bold text-green-900",children:_(R)})]}),(0,y.jsx)(C.A,{className:"h-8 w-8 text-green-600"})]})}),(0,y.jsx)("div",{className:"bg-purple-50 rounded-lg p-4",children:(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{className:"text-sm font-medium text-purple-600",children:"Accuracy"}),(0,y.jsxs)("p",{className:"text-2xl font-bold text-purple-900",children:[E.toFixed(1),"%"]})]}),(0,y.jsx)(D.A,{className:"h-8 w-8 text-purple-600"})]})}),(0,y.jsx)("div",{className:"bg-orange-50 rounded-lg p-4",children:(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{className:"text-sm font-medium text-orange-600",children:"Retention"}),(0,y.jsxs)("p",{className:"text-2xl font-bold text-orange-900",children:[F.toFixed(1),"%"]})]}),(0,y.jsx)(S.A,{className:"h-8 w-8 text-orange-600"})]})})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Deck Statistics"}),(0,y.jsx)("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg",children:(0,y.jsxs)("table",{className:"min-w-full divide-y divide-gray-300",children:[(0,y.jsx)("thead",{className:"bg-gray-50",children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Deck"}),(0,y.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total Cards"}),(0,y.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Due"}),(0,y.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Studied Today"}),(0,y.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Retention"}),(0,y.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Avg Ease"})]})}),(0,y.jsx)("tbody",{className:"divide-y divide-gray-200 bg-white",children:r.map(e=>(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.deck_name}),(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.total_cards}),(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,y.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.due_cards>0?"bg-red-100 text-red-800":"bg-green-100 text-green-800"),children:e.due_cards})}),(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.cards_studied_today}),(0,y.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.retention_rate.toFixed(1),"%"]}),(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.average_ease.toFixed(2)})]},e.deck_id))})]})})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Daily Progress"}),(0,y.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,y.jsx)("div",{className:"grid grid-cols-7 gap-2",children:o.slice(-7).map((e,s)=>(0,y.jsxs)("div",{className:"text-center",children:[(0,y.jsx)("div",{className:"text-xs text-gray-500 mb-2",children:A(e.date)}),(0,y.jsx)("div",{className:"bg-blue-500 rounded",style:{height:"".concat(Math.max(4,e.cards_studied/Math.max(...o.map(e=>e.cards_studied))*80),"px"),width:"20px",margin:"0 auto"}}),(0,y.jsx)("div",{className:"text-xs text-gray-700 mt-1",children:e.cards_studied})]},e.date))})})]})]}),"retention"===v&&(0,y.jsxs)("div",{className:"space-y-6",children:[(0,y.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Retention Analysis"}),m.length>0?(0,y.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:m.map(e=>(0,y.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,y.jsxs)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:[e.period_days," Days"]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsxs)("div",{className:"flex justify-between",children:[(0,y.jsx)("span",{className:"text-sm text-gray-600",children:"Total Reviews:"}),(0,y.jsx)("span",{className:"text-sm font-medium",children:e.total_reviews})]}),(0,y.jsxs)("div",{className:"flex justify-between",children:[(0,y.jsx)("span",{className:"text-sm text-gray-600",children:"Successful:"}),(0,y.jsx)("span",{className:"text-sm font-medium",children:e.successful_reviews})]}),(0,y.jsxs)("div",{className:"flex justify-between",children:[(0,y.jsx)("span",{className:"text-sm text-gray-600",children:"Retention Rate:"}),(0,y.jsxs)("span",{className:"text-sm font-medium ".concat(e.retention_rate>=85?"text-green-600":e.retention_rate>=75?"text-yellow-600":"text-red-600"),children:[e.retention_rate.toFixed(1),"%"]})]})]}),(0,y.jsx)("div",{className:"mt-4",children:(0,y.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,y.jsx)("div",{className:"h-2 rounded-full ".concat(e.retention_rate>=85?"bg-green-500":e.retention_rate>=75?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(e.retention_rate,"%")}})})})]},e.period_days))}):(0,y.jsx)("div",{className:"text-center py-8 text-gray-500",children:(0,y.jsx)("p",{children:"No retention data available for this period."})})]}),"workload"===v&&(0,y.jsxs)("div",{className:"space-y-6",children:[(0,y.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Predicted Workload"}),h.length>0?(0,y.jsx)("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg",children:(0,y.jsxs)("table",{className:"min-w-full divide-y divide-gray-300",children:[(0,y.jsx)("thead",{className:"bg-gray-50",children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),(0,y.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Reviews"}),(0,y.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"New Cards"}),(0,y.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total Workload"})]})}),(0,y.jsx)("tbody",{className:"divide-y divide-gray-200 bg-white",children:h.map(e=>(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:A(e.date)}),(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.predicted_reviews}),(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.predicted_new_cards}),(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,y.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.total_workload>50?"bg-red-100 text-red-800":e.total_workload>25?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:e.total_workload})})]},e.date))})]})}):(0,y.jsx)("div",{className:"text-center py-8 text-gray-500",children:(0,y.jsx)("p",{children:"No workload data available."})})]}),"sessions"===v&&(0,y.jsxs)("div",{className:"space-y-6",children:[(0,y.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Study Sessions"}),d.length>0?(0,y.jsx)("div",{className:"space-y-4",children:d.map(e=>(0,y.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,y.jsx)("h4",{className:"font-medium text-gray-900",children:e.deck_name}),(0,y.jsx)("span",{className:"text-sm text-gray-500",children:new Date(e.started_at).toLocaleDateString()})]}),(0,y.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-sm",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("span",{className:"text-gray-600",children:"Duration:"}),(0,y.jsx)("div",{className:"font-medium",children:_(e.duration_seconds)})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("span",{className:"text-gray-600",children:"Cards:"}),(0,y.jsx)("div",{className:"font-medium",children:e.cards_studied})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("span",{className:"text-gray-600",children:"Accuracy:"}),(0,y.jsxs)("div",{className:"font-medium",children:[e.cards_studied>0?(e.correct_answers/e.cards_studied*100).toFixed(1):0,"%"]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("span",{className:"text-gray-600",children:"New:"}),(0,y.jsx)("div",{className:"font-medium text-blue-600",children:e.new_cards})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("span",{className:"text-gray-600",children:"Reviews:"}),(0,y.jsx)("div",{className:"font-medium text-green-600",children:e.review_cards})]})]})]},e.id))}):(0,y.jsx)("div",{className:"text-center py-8 text-gray-500",children:(0,y.jsx)("p",{children:"No study sessions found for this period."})})]})]})]})};var E=t(3695),F=t(2391);const B=e=>{let{userId:s,onEditCard:t}=e;const[r,n]=(0,a.useState)([]),[d,c]=(0,a.useState)([]),[i,x]=(0,a.useState)([]),[u,h]=(0,a.useState)(!0),[b,j]=(0,a.useState)(!1),[f,v]=(0,a.useState)(null),[N,w]=(0,a.useState)(!1),[k,A]=(0,a.useState)(1),[C,I]=(0,a.useState)(1),[D,T]=(0,a.useState)(0),[R,B]=(0,a.useState)({query:"",deckId:"",cardType:"",tags:[],dateRange:{start:"",end:""},easeRange:{min:1.3,max:5},intervalRange:{min:0,max:36500},sortBy:"updated_at",sortOrder:"desc"}),q="https://api.legalight.org.in";(0,a.useEffect)(()=>{P()},[s]),(0,a.useEffect)(()=>{M()},[R,k]);const P=async()=>{try{const e=localStorage.getItem("auth_token"),[s,t]=await Promise.all([fetch("".concat(q,"/api/flashcards/decks?minimal=true"),{headers:{Authorization:"Bearer ".concat(e)}}),fetch("".concat(q,"/api/flashcards/tags"),{headers:{Authorization:"Bearer ".concat(e)}})]),[a,r]=await Promise.all([s.json(),t.json()]);c(a),x(r)}catch(e){console.error("Failed to load decks and tags:",e)}},M=(0,a.useCallback)(async()=>{try{h(!0);const e=localStorage.getItem("auth_token"),s=new URLSearchParams((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)({page:k.toString(),limit:20..toString(),sort_by:R.sortBy,sort_order:R.sortOrder},R.query&&{query:R.query}),R.deckId&&{deck_id:R.deckId}),R.cardType&&{card_type:R.cardType}),R.tags.length>0&&{tags:R.tags.join(",")}),R.dateRange.start&&{date_start:R.dateRange.start}),R.dateRange.end&&{date_end:R.dateRange.end}),{},{ease_min:R.easeRange.min.toString(),ease_max:R.easeRange.max.toString(),interval_min:R.intervalRange.min.toString(),interval_max:R.intervalRange.max.toString()})),t=await fetch("".concat(q,"/api/flashcards/cards/search?").concat(s),{headers:{Authorization:"Bearer ".concat(e)}}),a=await t.json();n(a.cards),T(a.total),I(Math.ceil(a.total/20))}catch(e){console.error("Failed to search cards:",e)}finally{h(!1)}},[k,R]),L=(e,s)=>{let t=e;return Object.entries(s).forEach(s=>{let[a,r]=s;const n="{{".concat(a,"}}");t="Text"===a&&e.includes("{{cloze:Text}}")?t.replace("{{cloze:Text}}",r):t.replace(n,r)}),t=t.replace(/\{\{[^}]+\}\}/g,""),t},O=e=>({0:"New",1:"Learning",2:"Review",3:"Relearning"}[e]||"Unknown"),H=e=>({0:"bg-blue-100 text-blue-800",1:"bg-orange-100 text-orange-800",2:"bg-green-100 text-green-800",3:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-800");return(0,y.jsxs)("div",{className:"bg-white rounded-lg shadow-lg",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,y.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Card Browser"}),(0,y.jsxs)("span",{className:"text-sm text-gray-500",children:["(",D," cards)"]})]}),(0,y.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,y.jsxs)("button",{onClick:()=>j(!b),className:"flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors ".concat(b?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,y.jsx)(E.A,{className:"h-4 w-4"}),(0,y.jsx)("span",{children:"Filters"})]}),(0,y.jsx)("button",{onClick:M,className:"p-2 hover:bg-gray-100 rounded-lg",title:"Refresh",children:(0,y.jsx)(z.A,{className:"h-5 w-5 text-gray-600"})})]})]}),(0,y.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,y.jsxs)("div",{className:"relative",children:[(0,y.jsx)(l.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,y.jsx)("input",{type:"text",value:R.query,onChange:e=>B(s=>(0,o.A)((0,o.A)({},s),{},{query:e.target.value})),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Search cards by content, tags, or note type..."})]})}),b&&(0,y.jsxs)("div",{className:"p-6 bg-gray-50 border-b border-gray-200",children:[(0,y.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deck"}),(0,y.jsxs)("select",{value:R.deckId,onChange:e=>B(s=>(0,o.A)((0,o.A)({},s),{},{deckId:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,y.jsx)("option",{value:"",children:"All Decks"}),d.map(e=>(0,y.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Card Type"}),(0,y.jsxs)("select",{value:R.cardType,onChange:e=>B(s=>(0,o.A)((0,o.A)({},s),{},{cardType:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,y.jsx)("option",{value:"",children:"All Types"}),(0,y.jsx)("option",{value:"0",children:"New"}),(0,y.jsx)("option",{value:"1",children:"Learning"}),(0,y.jsx)("option",{value:"2",children:"Review"}),(0,y.jsx)("option",{value:"3",children:"Relearning"})]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sort By"}),(0,y.jsxs)("select",{value:R.sortBy,onChange:e=>B(s=>(0,o.A)((0,o.A)({},s),{},{sortBy:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,y.jsx)("option",{value:"updated_at",children:"Last Modified"}),(0,y.jsx)("option",{value:"created_at",children:"Created Date"}),(0,y.jsx)("option",{value:"due",children:"Due Date"}),(0,y.jsx)("option",{value:"ease_factor",children:"Ease Factor"}),(0,y.jsx)("option",{value:"interval",children:"Interval"}),(0,y.jsx)("option",{value:"reps",children:"Reviews"})]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order"}),(0,y.jsxs)("select",{value:R.sortOrder,onChange:e=>B(s=>(0,o.A)((0,o.A)({},s),{},{sortOrder:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,y.jsx)("option",{value:"desc",children:"Descending"}),(0,y.jsx)("option",{value:"asc",children:"Ascending"})]})]})]}),(0,y.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,y.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,y.jsxs)("div",{children:[(0,y.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Ease Factor Range (",R.easeRange.min," - ",R.easeRange.max,")"]}),(0,y.jsxs)("div",{className:"flex space-x-2",children:[(0,y.jsx)("input",{type:"range",min:"1.3",max:"5.0",step:"0.1",value:R.easeRange.min,onChange:e=>B(s=>(0,o.A)((0,o.A)({},s),{},{easeRange:(0,o.A)((0,o.A)({},s.easeRange),{},{min:parseFloat(e.target.value)})})),className:"flex-1"}),(0,y.jsx)("input",{type:"range",min:"1.3",max:"5.0",step:"0.1",value:R.easeRange.max,onChange:e=>B(s=>(0,o.A)((0,o.A)({},s),{},{easeRange:(0,o.A)((0,o.A)({},s.easeRange),{},{max:parseFloat(e.target.value)})})),className:"flex-1"})]})]}),(0,y.jsxs)("div",{children:[(0,y.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Interval Range (",R.intervalRange.min," - ",R.intervalRange.max," days)"]}),(0,y.jsxs)("div",{className:"flex space-x-2",children:[(0,y.jsx)("input",{type:"number",value:R.intervalRange.min,onChange:e=>B(s=>(0,o.A)((0,o.A)({},s),{},{intervalRange:(0,o.A)((0,o.A)({},s.intervalRange),{},{min:parseInt(e.target.value)||0})})),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Min"}),(0,y.jsx)("input",{type:"number",value:R.intervalRange.max,onChange:e=>B(s=>(0,o.A)((0,o.A)({},s),{},{intervalRange:(0,o.A)((0,o.A)({},s.intervalRange),{},{max:parseInt(e.target.value)||36500})})),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Max"})]})]})]})}),(0,y.jsx)("div",{className:"mt-4 flex justify-end",children:(0,y.jsx)("button",{onClick:()=>{B({query:"",deckId:"",cardType:"",tags:[],dateRange:{start:"",end:""},easeRange:{min:1.3,max:5},intervalRange:{min:0,max:36500},sortBy:"updated_at",sortOrder:"desc"}),A(1)},className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium",children:"Reset Filters"})})]}),(0,y.jsx)("div",{className:"divide-y divide-gray-200",children:u?(0,y.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,y.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):0===r.length?(0,y.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,y.jsx)("p",{className:"text-lg font-medium",children:"No cards found"}),(0,y.jsx)("p",{className:"text-sm",children:"Try adjusting your search filters"})]}):r.map(e=>{return(0,y.jsx)("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,y.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(H(e.card_type)),children:O(e.card_type)}),(0,y.jsx)("span",{className:"text-sm text-gray-500",children:e.deck_name}),(0,y.jsx)("span",{className:"text-sm text-gray-500",children:e.note.note_type.name}),-1===e.queue&&(0,y.jsx)("span",{className:"px-2 py-1 bg-gray-200 text-gray-700 rounded-full text-xs font-medium",children:"Suspended"})]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)("div",{className:"text-sm text-gray-900 line-clamp-2",dangerouslySetInnerHTML:{__html:L("{{Front}}",e.note.fields)||Object.values(e.note.fields)[0]||"No content"}}),(0,y.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[(0,y.jsxs)("span",{children:["Ease: ",e.ease_factor.toFixed(2)]}),(0,y.jsxs)("span",{children:["Interval: ",e.interval,"d"]}),(0,y.jsxs)("span",{children:["Reviews: ",e.reps]}),e.lapses>0&&(0,y.jsxs)("span",{children:["Lapses: ",e.lapses]}),(0,y.jsxs)("span",{children:["Modified: ",(s=e.updated_at,new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))]})]}),e.note.tags.length>0&&(0,y.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:e.note.tags.map(e=>(0,y.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded",children:e},e))})]})]}),(0,y.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,y.jsx)("button",{onClick:()=>{v(e),w(!0)},className:"p-2 hover:bg-gray-200 rounded-lg text-gray-600 hover:text-gray-800",title:"Preview",children:(0,y.jsx)(S.A,{className:"h-4 w-4"})}),(0,y.jsx)("button",{onClick:()=>t(e),className:"p-2 hover:bg-gray-200 rounded-lg text-gray-600 hover:text-gray-800",title:"Edit",children:(0,y.jsx)(g.A,{className:"h-4 w-4"})}),(0,y.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to reset this card's learning progress?"))try{const s=localStorage.getItem("auth_token");await fetch("".concat(q,"/api/flashcards/cards/").concat(e,"/reset"),{method:"POST",headers:{Authorization:"Bearer ".concat(s)}}),M()}catch(s){console.error("Failed to reset card:",s)}})(e.id),className:"p-2 hover:bg-gray-200 rounded-lg text-gray-600 hover:text-gray-800",title:"Reset Progress",children:(0,y.jsx)(z.A,{className:"h-4 w-4"})}),(0,y.jsx)("button",{onClick:()=>(async(e,s)=>{try{const t=localStorage.getItem("auth_token");await fetch("".concat(q,"/api/flashcards/cards/").concat(e,"/suspend"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({suspended:s})}),M()}catch(t){console.error("Failed to suspend/unsuspend card:",t)}})(e.id,-1!==e.queue),className:"p-2 hover:bg-gray-200 rounded-lg ".concat(-1===e.queue?"text-green-600":"text-orange-600"),title:-1===e.queue?"Unsuspend":"Suspend",children:(0,y.jsx)(_.A,{className:"h-4 w-4"})}),(0,y.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this card?"))try{const s=localStorage.getItem("auth_token");await fetch("".concat(q,"/api/flashcards/cards/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(s)}}),M()}catch(s){console.error("Failed to delete card:",s)}})(e.id),className:"p-2 hover:bg-gray-200 rounded-lg text-red-600 hover:text-red-800",title:"Delete",children:(0,y.jsx)(p.A,{className:"h-4 w-4"})})]})]})},e.id);var s})}),C>1&&(0,y.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-t border-gray-200",children:[(0,y.jsxs)("div",{className:"text-sm text-gray-700",children:["Showing ",20*(k-1)+1," to ",Math.min(20*k,D)," of ",D," cards"]}),(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,y.jsx)("button",{onClick:()=>A(e=>Math.max(1,e-1)),disabled:1===k,className:"p-2 rounded-lg border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:(0,y.jsx)(F.A,{className:"h-4 w-4"})}),(0,y.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",k," of ",C]}),(0,y.jsx)("button",{onClick:()=>A(e=>Math.min(C,e+1)),disabled:k===C,className:"p-2 rounded-lg border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:(0,y.jsx)(m.A,{className:"h-4 w-4"})})]})]}),N&&f&&(0,y.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,y.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,y.jsx)("h3",{className:"text-lg font-semibold",children:"Card Preview"}),(0,y.jsx)("button",{onClick:()=>w(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,y.jsx)(_.A,{className:"h-5 w-5"})})]}),(0,y.jsxs)("div",{className:"p-6 space-y-6",children:[(0,y.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("span",{className:"font-medium",children:"Deck:"})," ",f.deck_name]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("span",{className:"font-medium",children:"Type:"})," ",f.note.note_type.name]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("span",{className:"font-medium",children:"Status:"}),(0,y.jsx)("span",{className:"ml-2 px-2 py-1 rounded-full text-xs ".concat(H(f.card_type)),children:O(f.card_type)})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("span",{className:"font-medium",children:"Reviews:"})," ",f.reps]})]})}),(0,y.jsx)("div",{className:"space-y-4",children:Object.entries(f.note.fields).map(e=>{let[s,t]=e;return(0,y.jsxs)("div",{children:[(0,y.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:s}),(0,y.jsx)("div",{className:"border rounded-lg p-4 bg-gray-50",dangerouslySetInnerHTML:{__html:t}})]},s)})}),f.note.tags.length>0&&(0,y.jsxs)("div",{children:[(0,y.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Tags"}),(0,y.jsx)("div",{className:"flex flex-wrap gap-2",children:f.note.tags.map(e=>(0,y.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-sm rounded",children:e},e))})]})]})]})})]})};var q=t(3421),P=t(5516),M=t(2765),L=t(8003),O=t(8505);const H=e=>{let{onClose:s,onSave:t}=e;const[r,n]=(0,a.useState)({name:"",description:"",version:"1.0.0",author:"",javascript_code:"// Add-on JavaScript code\n// Available APIs:\n// - flashcardAPI.addCard(deckId, noteData)\n// - flashcardAPI.updateCard(cardId, updates)  \n// - flashcardAPI.deleteCard(cardId)\n// - flashcardAPI.getDecks()\n// - flashcardAPI.getCurrentUser()\n\nconsole.log('Add-on loaded successfully!');\n\n// Example: Add a custom button to the study interface\nfunction initializeAddon() {\n  // Your initialization code here\n}\n\n// Call initialization when addon loads\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', initializeAddon);\n} else {\n  initializeAddon();\n}",css_code:"/* Add-on CSS styles */\n.addon-button {\n  background-color: #8b5cf6;\n  color: white;\n  padding: 8px 16px;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 14px;\n}\n\n.addon-button:hover {\n  background-color: #7c3aed;\n}",permissions:[],trusted:!1});return(0,y.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,y.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,y.jsx)("h3",{className:"text-lg font-semibold",children:"Create Add-on"}),(0,y.jsx)("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,y.jsx)(q.A,{className:"h-5 w-5"})})]}),(0,y.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=localStorage.getItem("auth_token"),s="https://api.legalight.org.in";await fetch("".concat(s,"/api/flashcards/addons"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(r)}),t()}catch(s){console.error("Failed to create addon:",s)}},className:"p-6 space-y-6",children:[(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),(0,y.jsx)("input",{type:"text",value:r.name,onChange:e=>n(s=>(0,o.A)((0,o.A)({},s),{},{name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Version *"}),(0,y.jsx)("input",{type:"text",value:r.version,onChange:e=>n(s=>(0,o.A)((0,o.A)({},s),{},{version:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0})]})]}),(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Author *"}),(0,y.jsx)("input",{type:"text",value:r.author,onChange:e=>n(s=>(0,o.A)((0,o.A)({},s),{},{author:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0})]}),(0,y.jsxs)("div",{className:"flex items-center",children:[(0,y.jsx)("input",{type:"checkbox",id:"trusted",checked:r.trusted,onChange:e=>n(s=>(0,o.A)((0,o.A)({},s),{},{trusted:e.target.checked})),className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"}),(0,y.jsx)("label",{htmlFor:"trusted",className:"ml-2 text-sm text-gray-700",children:"Mark as trusted"})]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),(0,y.jsx)("textarea",{value:r.description,onChange:e=>n(s=>(0,o.A)((0,o.A)({},s),{},{description:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",rows:3,required:!0})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Permissions"}),(0,y.jsx)("div",{className:"grid grid-cols-2 gap-2",children:["cards.read","cards.write","cards.delete","decks.read","decks.write","analytics.read","user.read","dom.modify","network.request","storage.local"].map(e=>(0,y.jsxs)("label",{className:"flex items-center",children:[(0,y.jsx)("input",{type:"checkbox",checked:r.permissions.includes(e),onChange:()=>(e=>{n(s=>(0,o.A)((0,o.A)({},s),{},{permissions:s.permissions.includes(e)?s.permissions.filter(s=>s!==e):[...s.permissions,e]}))})(e),className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"}),(0,y.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:e})]},e))})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"JavaScript Code"}),(0,y.jsx)("textarea",{value:r.javascript_code,onChange:e=>n(s=>(0,o.A)((0,o.A)({},s),{},{javascript_code:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 font-mono text-sm",rows:12})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CSS Code"}),(0,y.jsx)("textarea",{value:r.css_code,onChange:e=>n(s=>(0,o.A)((0,o.A)({},s),{},{css_code:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 font-mono text-sm",rows:8})]}),(0,y.jsxs)("div",{className:"flex space-x-3",children:[(0,y.jsx)("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,y.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Create Add-on"})]})]})]})})},U=e=>{let{addon:s,onClose:t}=e;return(0,y.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,y.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,y.jsxs)("h3",{className:"text-lg font-semibold",children:[s.name," Details"]}),(0,y.jsx)("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,y.jsx)(q.A,{className:"h-5 w-5"})})]}),(0,y.jsxs)("div",{className:"p-6 space-y-6",children:[(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("h4",{className:"font-medium text-gray-900 mb-1",children:"Version"}),(0,y.jsx)("p",{className:"text-gray-600",children:s.version})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h4",{className:"font-medium text-gray-900 mb-1",children:"Author"}),(0,y.jsx)("p",{className:"text-gray-600",children:s.author})]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h4",{className:"font-medium text-gray-900 mb-1",children:"Description"}),(0,y.jsx)("p",{className:"text-gray-600",children:s.description})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Permissions"}),(0,y.jsx)("div",{className:"flex flex-wrap gap-2",children:s.permissions.map(e=>(0,y.jsx)("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-sm rounded",children:e},e))})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"JavaScript Code"}),(0,y.jsx)("pre",{className:"bg-gray-100 p-4 rounded-lg text-sm overflow-x-auto max-h-64 overflow-y-auto",children:(0,y.jsx)("code",{children:s.javascript_code})})]}),s.css_code&&(0,y.jsxs)("div",{children:[(0,y.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"CSS Code"}),(0,y.jsx)("pre",{className:"bg-gray-100 p-4 rounded-lg text-sm overflow-x-auto max-h-64 overflow-y-auto",children:(0,y.jsx)("code",{children:s.css_code})})]})]})]})})},J=e=>{let{userId:s}=e;const[t,r]=(0,a.useState)([]),[n,l]=(0,a.useState)(!0),[c,i]=(0,a.useState)(!1),[x,m]=(0,a.useState)(null),[u,h]=(0,a.useState)(null),g="https://api.legalight.org.in";(0,a.useEffect)(()=>{j()},[s]);const j=async()=>{try{l(!0);const e=localStorage.getItem("auth_token"),s=await fetch("".concat(g,"/api/flashcards/addons"),{headers:{Authorization:"Bearer ".concat(e)}}),t=await s.json();r(t)}catch(e){console.error("Failed to load addons:",e)}finally{l(!1)}},f=e=>e.enabled?e.trusted?(0,y.jsx)(M.A,{className:"h-5 w-5 text-green-500"}):(0,y.jsx)(P.A,{className:"h-5 w-5 text-yellow-500"}):(0,y.jsx)(q.A,{className:"h-5 w-5 text-gray-400"}),v=e=>e.enabled?e.trusted?"Active":"Untrusted":"Disabled",N=e=>e.enabled?e.trusted?"text-green-600":"text-yellow-600":"text-gray-500";return n?(0,y.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,y.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,y.jsxs)("div",{className:"bg-white rounded-lg shadow-lg",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,y.jsx)(d.A,{className:"h-6 w-6 text-purple-600"}),(0,y.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Add-ons Manager"})]}),(0,y.jsx)("button",{onClick:()=>i(!0),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors",children:"Create Add-on"})]}),(0,y.jsx)("div",{className:"divide-y divide-gray-200",children:0===t.length?(0,y.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,y.jsx)(d.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,y.jsx)("p",{className:"text-lg font-medium",children:"No add-ons installed"}),(0,y.jsx)("p",{className:"text-sm",children:"Create your first add-on to extend functionality"})]}):t.map(e=>(0,y.jsx)("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[f(e),(0,y.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),(0,y.jsxs)("span",{className:"text-sm text-gray-500",children:["v",e.version]}),(0,y.jsx)("span",{className:"text-sm font-medium ".concat(N(e)),children:v(e)})]}),(0,y.jsx)("p",{className:"text-gray-600 mb-2",children:e.description}),(0,y.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[(0,y.jsxs)("span",{children:["By ",e.author]}),(0,y.jsx)("span",{children:"\u2022"}),(0,y.jsxs)("span",{children:["Permissions: ",e.permissions.length]}),(0,y.jsx)("span",{children:"\u2022"}),(0,y.jsxs)("span",{children:["Updated ",new Date(e.updated_at).toLocaleDateString()]})]}),e.permissions.length>0&&(0,y.jsx)("div",{className:"mt-2",children:(0,y.jsx)("div",{className:"flex flex-wrap gap-1",children:e.permissions.map(e=>(0,y.jsx)("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded",children:e},e))})})]}),(0,y.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,y.jsx)("button",{onClick:()=>{h(e),m(e.id)},className:"p-2 hover:bg-gray-200 rounded-lg text-gray-600 hover:text-gray-800",title:"View Details",children:(0,y.jsx)(S.A,{className:"h-4 w-4"})}),(0,y.jsx)("button",{onClick:()=>(async(e,s)=>{try{const t=localStorage.getItem("auth_token");await fetch("".concat(g,"/api/flashcards/addons/").concat(e,"/toggle"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({enabled:s})}),r(t=>t.map(t=>t.id===e?(0,o.A)((0,o.A)({},t),{},{enabled:s}):t))}catch(t){console.error("Failed to toggle addon:",t)}})(e.id,!e.enabled),className:"p-2 hover:bg-gray-200 rounded-lg transition-colors ".concat(e.enabled?"text-red-600 hover:text-red-800":"text-green-600 hover:text-green-800"),title:e.enabled?"Disable":"Enable",children:e.enabled?(0,y.jsx)(L.A,{className:"h-4 w-4"}):(0,y.jsx)(O.A,{className:"h-4 w-4"})}),(0,y.jsx)("button",{className:"p-2 hover:bg-gray-200 rounded-lg text-gray-600 hover:text-gray-800",title:"Configure",children:(0,y.jsx)(b.A,{className:"h-4 w-4"})}),(0,y.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this addon?"))try{const s=localStorage.getItem("auth_token");await fetch("".concat(g,"/api/flashcards/addons/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(s)}}),r(s=>s.filter(s=>s.id!==e))}catch(s){console.error("Failed to delete addon:",s)}})(e.id),className:"p-2 hover:bg-gray-200 rounded-lg text-red-600 hover:text-red-800",title:"Delete",children:(0,y.jsx)(p.A,{className:"h-4 w-4"})})]})]})},e.id))}),c&&(0,y.jsx)(H,{onClose:()=>i(!1),onSave:()=>{i(!1),j()}}),x&&u&&(0,y.jsx)(U,{addon:u,onClose:()=>{m(null),h(null)}})]})},V=e=>{let{user:s,onLogout:t}=e;const[o,x]=(0,a.useState)("decks"),[m,u]=(0,a.useState)(null),[h,g]=(0,a.useState)(null),[p,b]=(0,a.useState)(null),[j,f]=(0,a.useState)(null);(0,a.useEffect)(()=>{v()},[]);const v=async()=>{try{const e=localStorage.getItem("auth_token"),t="https://api.legalight.org.in",a=await fetch("".concat(t,"/api/flashcards/addons?enabled=true"),{headers:{Authorization:"Bearer ".concat(e)}});(await a.json()).forEach(a=>{if(a.css_code){const e=document.createElement("style");e.textContent=a.css_code,e.setAttribute("data-addon-id",a.id),document.head.appendChild(e)}if(a.javascript_code&&a.trusted)try{const r={console:console,document:document,window:window,flashcardAPI:{addCard:(e,s)=>{console.log("Addon adding card:",e,s)},updateCard:(e,s)=>{console.log("Addon updating card:",e,s)},deleteCard:e=>{console.log("Addon deleting card:",e)},getDecks:async()=>(await fetch("".concat(t,"/api/flashcards/decks"),{headers:{Authorization:"Bearer ".concat(e)}})).json(),getCurrentUser:()=>s}};new Function(...Object.keys(r),a.javascript_code)(...Object.values(r))}catch(r){console.error("Error loading addon ".concat(a.name,":"),r)}})}catch(e){console.error("Failed to load addons:",e)}},w=e=>{u(e),x("decks")},_=e=>{b(null),x("decks"),alert("Study session complete! Studied ".concat(e.cards_studied," cards in ").concat(Math.floor(e.session_duration/60)," minutes."))},A=e=>{f(e),g(null),x("editor")},C=e=>{g(e),f(null),x("editor")},S=e=>{console.log("Saving card:",e),x("decks"),g(null),f(null)},D=()=>{x("decks"),g(null),f(null)},z=[{id:"decks",label:"Decks",icon:r.A},{id:"analytics",label:"Analytics",icon:n.A},{id:"browser",label:"Browse Cards",icon:l.A},{id:"addons",label:"Add-ons",icon:d.A},{id:"settings",label:"Settings",icon:c.A}],T=()=>{switch(o){case"decks":return(0,y.jsx)(N,{userId:s.id,onDeckSelect:w,onCreateCard:A});case"study":return p?(0,y.jsx)(I,{deckId:p,onComplete:_,onExit:()=>{b(null),x("decks")}}):(0,y.jsx)("div",{className:"text-center py-12",children:(0,y.jsx)("p",{children:"No study session active"})});case"analytics":return(0,y.jsx)(R,{userId:s.id,selectedDeckId:null===m||void 0===m?void 0:m.id});case"browser":return(0,y.jsx)(B,{userId:s.id,onEditCard:C});case"addons":return(0,y.jsx)(J,{userId:s.id});case"editor":return(0,y.jsx)(k,{onSave:S,onCancel:D,initialNote:h,deckId:j||(null===h||void 0===h?void 0:h.deck_id)||""});case"settings":return(0,y.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,y.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Settings"}),(0,y.jsxs)("div",{className:"space-y-4",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Study Preferences"}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsxs)("label",{className:"flex items-center",children:[(0,y.jsx)("input",{type:"checkbox",className:"mr-2"}),(0,y.jsx)("span",{children:"Show timer during study"})]}),(0,y.jsxs)("label",{className:"flex items-center",children:[(0,y.jsx)("input",{type:"checkbox",className:"mr-2"}),(0,y.jsx)("span",{children:"Auto-play audio"})]}),(0,y.jsxs)("label",{className:"flex items-center",children:[(0,y.jsx)("input",{type:"checkbox",className:"mr-2"}),(0,y.jsx)("span",{children:"Night mode"})]})]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Backup & Sync"}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Export Data"}),(0,y.jsx)("button",{className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Import Data"})]})]})]})]});default:return(0,y.jsx)("div",{children:"View not found"})}};return"study"===o?T():(0,y.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,y.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,y.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,y.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,y.jsx)(i.A,{className:"h-8 w-8 text-blue-600"}),(0,y.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Flashcard System"})]}),(0,y.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,y.jsxs)("span",{className:"text-sm text-gray-600",children:["Welcome, ",s.name]}),(0,y.jsx)("button",{onClick:t,className:"px-4 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-lg text-sm font-medium",children:"Logout"})]})]})})}),(0,y.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,y.jsxs)("div",{className:"flex space-x-8",children:[(0,y.jsx)("div",{className:"w-64 flex-shrink-0",children:(0,y.jsxs)("nav",{className:"bg-white rounded-lg shadow-lg",children:[(0,y.jsxs)("div",{className:"p-4",children:[(0,y.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Navigation"}),(0,y.jsx)("ul",{className:"space-y-2",children:z.map(e=>(0,y.jsx)("li",{children:(0,y.jsxs)("button",{onClick:()=>x(e.id),className:"w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-left transition-colors ".concat(o===e.id?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-gray-100"),children:[(0,y.jsx)(e.icon,{className:"h-5 w-5"}),(0,y.jsx)("span",{children:e.label})]})},e.id))})]}),m&&(0,y.jsxs)("div",{className:"border-t p-4",children:[(0,y.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Quick Actions"}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsxs)("button",{onClick:()=>{return e=m.id,b(e),void x("study");var e},className:"w-full px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium",disabled:0===m.due_cards,children:["Study Now (",m.due_cards,")"]}),(0,y.jsx)("button",{onClick:()=>A(m.id),className:"w-full px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium",children:"Add Card"})]})]})]})}),(0,y.jsx)("div",{className:"flex-1",children:T()})]})})]})}}}]);